"use strict";var P=Object.create;var l=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty;var R=(t,e)=>{for(var n in e)l(t,n,{get:e[n],enumerable:!0})},S=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of b(e))!A.call(t,a)&&a!==n&&l(t,a,{get:()=>e[a],enumerable:!(r=O(e,a))||r.enumerable});return t};var u=(t,e,n)=>(n=t!=null?P(I(t)):{},S(e||!t||!t.__esModule?l(n,"default",{value:t,enumerable:!0}):n,t)),C=t=>S(l({},"__esModule",{value:!0}),t);var c=(t,e,n)=>new Promise((r,a)=>{var m=o=>{try{i(n.next(o))}catch(s){a(s)}},_=o=>{try{i(n.throw(o))}catch(s){a(s)}},i=o=>o.done?r(o.value):Promise.resolve(o.value).then(m,_);i((n=n.apply(t,e)).next())});var x={};R(x,{AwardsEntities:()=>y});module.exports=C(x);var w=require("dotenv/config"),d=u(require("mercadopago")),f=u(require("dayjs"));d.default.configurations.setAccessToken(String(process.env.MERCADO_PAGO_KEY_PROD));var p=class{static createPayment(e){return c(this,null,function*(){var a;let n={transaction_amount:e.transaction_amount,payment_method_id:"pix",payer:{email:e.payer.email},installments:1,date_of_expiration:String((0,f.default)(new Date).add(10,"minutes").format("YYYY-MM-DDTHH:mm:ss.000ZZ"))};return yield(a=d.default.payment)==null?void 0:a.save(n)})}static GetPayment(e){return c(this,null,function*(){return yield d.default.payment.findById(e)})}};var Y=require("dotenv/config"),E=u(require("mysql2")),v=E.default.createPool({host:process.env.MYSQL_HOST,user:process.env.MYSQL_USER,database:process.env.MYSQL_DATABASE,password:process.env.MYSQL_PASSWORD,waitForConnections:!0,connectionLimit:10,maxIdle:10,idleTimeout:6e4,queueLimit:0,enableKeepAlive:!0,keepAliveInitialDelay:0,charset:"utf8mb4"}),g=v.promise();var y=class{static addMoneyOnMatch(e){return c(this,null,function*(){var m,_,i;let[n]=yield g.query("SELECT * FROM VIEW_VERIFICAR_SE_EXISTE_PAGAMENTO_IN_PROCESSO;"),r=yield p.createPayment({transaction_amount:e,payment_method_id:"debit_card",payer:{email:"heuderdev@gmail.com"},installments:1});if(console.log(JSON.stringify(r,null,2)),((m=n[0])==null?void 0:m.id)!=null){let[o]=yield g.query("SELECT * FROM TB_ACUMULA_VALORES_CASO_AWARDS_DIFERENTE_IN_PROCESSING WHERE id = 1;"),s=Number((_=n[0])==null?void 0:_.subtract_premiums),M=s+e;console.log(Number((i=o[0])==null?void 0:i.amount)),console.log(s),console.log(M)}else console.log("RECURSO EM PROCESSO.");return{}})}};0&&(module.exports={AwardsEntities});
