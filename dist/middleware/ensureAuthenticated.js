"use strict";var c=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var y=(e,t)=>{for(var r in t)c(e,r,{get:t[r],enumerable:!0})},R=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of l(t))!x.call(e,o)&&o!==r&&c(e,o,{get:()=>t[o],enumerable:!(n=h(t,o))||n.enumerable});return e};var T=e=>R(c({},"__esModule",{value:!0}),e);var p=(e,t,r)=>new Promise((n,o)=>{var a=s=>{try{i(r.next(s))}catch(u){o(u)}},m=s=>{try{i(r.throw(s))}catch(u){o(u)}},i=s=>s.done?n(s.value):Promise.resolve(s.value).then(a,m);i((r=r.apply(e,t)).next())});var J={};y(J,{ensureAuthenticated:()=>j});module.exports=T(J);var d=require("jsonwebtoken");var v=require("dotenv/config"),f={jwt:{secret:process.env.JWT_STRING||"default",expiresIn:"365d"}};var j=(e,t,r)=>p(void 0,null,function*(){let n=e.headers.authorization;if(!n)return t.status(401).json("JWT n\xE3o informado");let[,o]=n.split(" ");try{let a=(0,d.verify)(o,f.jwt.secret);return e.user=JSON.parse(a.user),r()}catch(a){return t.status(401).json("JWT Token invalido")}});0&&(module.exports={ensureAuthenticated});
