"use strict";var O=Object.create;var i=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var d=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var y=(s,t)=>{for(var e in t)i(s,e,{get:t[e],enumerable:!0})},A=(s,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of b(t))!h.call(s,r)&&r!==e&&i(s,r,{get:()=>t[r],enumerable:!(o=R(t,r))||o.enumerable});return s};var L=(s,t,e)=>(e=s!=null?O(d(s)):{},A(t||!s||!s.__esModule?i(e,"default",{value:s,enumerable:!0}):e,s)),M=s=>A(i({},"__esModule",{value:!0}),s);var m=(s,t,e)=>new Promise((o,r)=>{var c=n=>{try{a(e.next(n))}catch(S){r(S)}},u=n=>{try{a(e.throw(n))}catch(S){r(S)}},a=n=>n.done?o(n.value):Promise.resolve(n.value).then(c,u);a((e=e.apply(s,t)).next())});var f={};y(f,{BetsController:()=>_});module.exports=M(f);var P=require("dotenv/config"),C=L(require("mysql2")),U=C.default.createPool({host:process.env.MYSQL_HOST,user:process.env.MYSQL_USER,database:process.env.MYSQL_DATABASE,password:process.env.MYSQL_PASSWORD,waitForConnections:!0,connectionLimit:10,maxIdle:10,idleTimeout:6e4,queueLimit:0,enableKeepAlive:!0,keepAliveInitialDelay:0,charset:"utf8mb4"}),l=U.promise();var p=class{static seekContestWinners(t,e){return m(this,null,function*(){return Promise.all([yield l.query("CALL PROCEDURE_BUSCAR_GANHADORES_POR_ESTABELECIMENTO_E_CONCURSO(?,?)",[t,e]),yield l.query("CALL PROCEDURE_BUSCAR_VALORES_A_SER_PAGO(?)",[e])])})}};var E=({error:s=!1,message:t="OPERA\xC7\xC3O EXECUTADA COM SUCESSO.",path:e,data:o,code:r=200})=>({code:r,error:s,message:t.toUpperCase(),path:e.toUpperCase(),data:o});var _=class{static search_concurso(t,e){return m(this,null,function*(){try{let{concurso:o}=t.body,r=t.user.establishmentId,c=yield p.seekContestWinners(Number(r),Number(o)),u=c[0][0][0],a=c[1][0][0],n=E({data:{_pagamento:a,_concursos:u},path:"BetsController:search_concurso"});return e.json(n)}catch(o){let r=E({error:!0,code:400,message:JSON.stringify(o),data:{},path:"BetsController:search_concurso"});return e.json(r)}})}};0&&(module.exports={BetsController});
